<!DOCTYPE html>
<html>
<head>
    <title>Invernaderos</title>
</head>
<body>
    <h1>Sistema de Invernaderos</h1>
    
    {% if not tiene_invernaderos %}
        <form action="/cargar" method="post" enctype="multipart/form-data">
            <label>Subir archivo XML de entrada:</label>
            <input type="file" name="archivo" accept=".xml" required>
            <button type="submit">Cargar</button>
        </form>
        <p>No hay invernaderos cargados. Por favor, sube un archivo XML.</p>
    {% else %}
        <h2>Seleccionar Invernadero</h2>
        <form action="/" method="post">
            <label>Invernadero:</label>
            <select name="invernadero">
                {% for inv in invernaderos %}
                    <option value="{{ inv.nombre }}" {% if primer_inv and inv.nombre == primer_inv.nombre %}selected{% endif %}>{{ inv.nombre }}</option>
                {% endfor %}
            </select>
            <button type="submit">Seleccionar</button>
        </form>

        <h2>Seleccionar Plan</h2>
        <form action="/graficar_instrucciones" method="post">
            <input type="hidden" name="invernadero" value="{{ primer_inv.nombre }}">
            <label>Plan:</label>
            <select name="plan">
                {% if primer_inv and primer_inv.planes %}
                    {% for plan in primer_inv.planes %}
                        <option value="{{ plan.nombre }}">{{ plan.nombre }}</option>
                    {% endfor %}
                {% else %}
                    <option value="">No hay planes</option>
                {% endif %}
            </select>
            <label>Tiempo m√°ximo (segundos):</label>
            <input type="number" name="tiempo" value="3" min="1" required>
            <button type="submit">Graficar instrucciones</button>
        </form>

        <h3>Invernaderos cargados:</h3>
        <ul>
        {% for inv in invernaderos %}
            <li>
                {{ inv.nombre }}
                <ul>
                    {% for plan in inv.planes %}
                        <li>{{ plan.nombre }}</li>
                    {% endfor %}
                </ul>
            </li>
        {% endfor %}
        </ul>
    {% endif %}
    <p>Debug: {% if invernaderos %} Lista enlazada cargada {% else %} No hay invernaderos {% endif %}</p>
    <ul>
    {% for inv in invernaderos %}
        <li>{{ inv.nombre }}</li>
    {% endfor %}
    </ul>
</body>
</html>